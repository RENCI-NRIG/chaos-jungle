## fullatom protein c-terminus patch

NAME CtermAmide
TYPES UPPER_TERMINUS

## general requirements for this patch

BEGIN_SELECTOR
PROPERTY PROTEIN
NOT VARIANT_TYPE UPPER_TERMINUS
END_SELECTOR

## now we search for a case that matches the residue, take the first one
## so put generic case last

BEGIN_CASE ### THE GENERAL CASE ##########################################

## these are the operations involved

ADD_ATOM  NT  NH2O NH2 -0.62
ADD_ATOM 1HE2 Hpol H   0.3
ADD_ATOM 2HE2 Hpol H   0.3
ADD_BOND C NT
ADD_BOND NT 1HE2
ADD_BOND NT 2HE2
SET_BACKBONE_HEAVYATOM NT
SET_POLYMER_CONNECT UPPER NONE

## making these up:

SET_ICOOR O  180.0 60 1.2 C CA N
SET_ICOOR NT 180.0 60 1.2 C CA O ## phi == 180 --> planar
SET_ICOOR 1HE2 180 60 1 NT C CA
SET_ICOOR 2HE2 180 60 1 NT C 1HE2

## modify properties of existing atoms

SET_ATOM_TYPE O ONH2
SET_ATOM_TYPE C CNH2
SET_MM_ATOM_TYPE O O
SET_MM_ATOM_TYPE C CC
SET_ATOMIC_CHARGE C 0.55
SET_ATOMIC_CHARGE O -0.55

ADD_PROPERTY UPPER_TERMINUS ## implies terminus

END_CASE

