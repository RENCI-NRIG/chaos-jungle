<rdf:RDF
    xmlns:ec2="http://geni-orca.renci.org/owl/ec2.owl#"
    xmlns:kansei="http://geni-orca.renci.org/owl/kansei.owl#"
    xmlns:app-color="http://geni-orca.renci.org/owl/app-color.owl#"
    xmlns:geni="http://geni-orca.renci.org/owl/geni.owl#"
    xmlns:domain="http://geni-orca.renci.org/owl/domain.owl#"
    xmlns:eucalyptus="http://geni-orca.renci.org/owl/eucalyptus.owl#"
    xmlns:collections="http://geni-orca.renci.org/owl/collections.owl#"
    xmlns:openflow="http://geni-orca.renci.org/owl/openflow.owl#"
    xmlns:xsd="http://www.w3.org/2001/XMLSchema#"
    xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#"
    xmlns:request="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#"
    xmlns:exogeni="http://geni-orca.renci.org/owl/exogeni.owl#"
    xmlns:layer="http://geni-orca.renci.org/owl/layer.owl#"
    xmlns:rdfs="http://www.w3.org/2000/01/rdf-schema#"
    xmlns:request-schema="http://geni-orca.renci.org/owl/request.owl#"
    xmlns:ip4="http://geni-orca.renci.org/owl/ip4.owl#"
    xmlns:planetlab="http://geni-orca.renci.org/owl/planetlab.owl#"
    xmlns:ethernet="http://geni-orca.renci.org/owl/ethernet.owl#"
    xmlns:dtn="http://geni-orca.renci.org/owl/dtn.owl#"
    xmlns:time="http://www.w3.org/2006/time#"
    xmlns:owl="http://www.w3.org/2002/07/owl#"
    xmlns:modify-schema="http://geni-orca.renci.org/owl/modify.owl#"
    xmlns:compute="http://geni-orca.renci.org/owl/compute.owl#"
    xmlns:topology="http://geni-orca.renci.org/owl/topology.owl#"
    xmlns:orca="http://geni-orca.renci.org/owl/orca.rdf#" > 
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginUC"/>
    <topology:hasGUID>b7beb18b-d761-45ab-afb9-2e8e9dd47e71</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginStarLightRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-CENIC-ip-10-100-0-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.0.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginUC-ip-192-168-11-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.11.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginFNAL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginStarLightRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>273b2107-3c59-4505-b140-177b37406cd0</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNL-ip-192-168-16-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.16.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-OriginNCSARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-OriginNCSARouter-ip-172-16-13-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-StarLight-ip-172-16-10-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.10.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheUC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheUC-ip-192-168-25-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNL-ip-192-168-20-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginCal">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCal"/>
    <topology:hasGUID>d62abb52-6bf4-4dc3-ba2d-cb108dbd8a60</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginCalRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheStarLightRouter-ip-192-168-26-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.26.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-I2-ip-172-16-27-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSCRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>dcde230e-4702-4179-a503-4c2e9ee322b7</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-CacheUNLRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-CacheUNLRouter-ip-172-16-3-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-CacheCENICRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>4914c93b-3ed2-4df9-8291-46488c98a6db</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-CacheUNLRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>5ef017e4-3443-425a-9001-f3b2945e27a5</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNYRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNYRouter-ip-192-168-28-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-I2-ip-172-16-27-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.27.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginStarLightRouter-ip-192-168-21-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CacheCENICRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CacheCENICRouter-ip-172-16-12-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CENIC">
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <topology:hasGUID>f458477e-42a1-43fe-a84b-5b7e084b85a8</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-CENIC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-CENIC"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CENIC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-CENIC"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-CENIC"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#">
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#I2"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CENIC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginNCSARouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginSDSCRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCal"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheStarLightRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUNL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheNY"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUNLRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginSDSC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13"/>
    <request-schema:hasTerm rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Term"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#ESNET"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/request.owl#Reservation"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginCal"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUNL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginFNAL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUNLRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheFNAL"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginNCSA"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#StarLight"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheSDSC"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginCalRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheNYRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginStarLightRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCENICRouter"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26"/>
    <collections:element rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginNCSARouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-OriginNCSARouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#I2"/>
    <topology:hasGUID>64112d4f-1ded-4ad7-94f8-5a60ee191d5f</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNY">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNY-ip-192-168-28-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-ESNET-ip-172-16-22-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.22.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-I2-ip-172-16-3-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUNLRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-OriginUNLRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNLRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#I2"/>
    <topology:hasGUID>1f8f869b-97c8-4553-a182-8fcdc3464123</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-OriginStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-StarLight"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3c1a7330-a5cb-4024-b69d-18a091803ec8</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCal">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCal-ip-192-168-23-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginSDSCRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-OriginSDSCRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSCRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CENIC"/>
    <topology:hasGUID>380c1584-83a1-4579-9455-ce467055a63a</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-OriginCalRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-ESNET"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d03533d3-a1e5-41d5-822e-76bb2dfa3f45</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCENICRouter-ip-192-168-19-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.19.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheSDSC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheCENICRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>5e53a2f2-2e33-4749-bbb2-400fdc5afce4</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-I2-ip-172-16-13-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.13.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-CENIC-ip-10-100-9-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.9.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>e7404f1b-d273-4148-a896-ce7eb77bcc88</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSCRouter-ip-192-168-17-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.17.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCal-ip-192-168-19-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.19.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNLRouter-ip-192-168-16-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.16.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUNLRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNLRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-CacheUNLRouter"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#I2"/>
    <topology:hasGUID>5f9ce95f-afbc-4a3b-8190-caf8278349b9</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp



</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginStarLightRouter-ip-192-168-11-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-CacheNYRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>8ef46008-e52b-4005-9727-f501c31c9e6c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSA"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSARouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>ca6062f7-dd86-4d54-9c12-0c7908bdb7e6</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginFNAL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginFNAL-ip-192-168-21-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CacheCENICRouter-ip-172-16-12-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.12.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-I2-ip-172-16-14-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheFNAL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheFNAL-ip-192-168-26-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSA">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSA-ip-192-168-15-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-I2-ip-10-100-6-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheSDSC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheSDSC-ip-192-168-18-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#ESNET">
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasGUID>32eb38f5-294b-4599-8de2-69a485881f7c</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-ESNET"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-ESNET"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-CacheUNLRouter-ip-172-16-3-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.3.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-I2-ip-172-16-3-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.3.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-CENIC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>a0010898-24ac-4142-8099-c10dead2c006</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCENICRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCENICRouter-ip-192-168-19-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-OriginUNLRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-OriginUNLRouter-ip-172-16-14-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-CacheCENICRouter-ip-172-16-4-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.4.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-CacheStarLightRouter-ip-172-16-24-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.24.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-ESNET-ip-10-100-1-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.1.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-StarLight-ip-10-100-7-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.7.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-I2-ip-10-100-6-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.6.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUNL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUNLRouter"/>
    <topology:hasGUID>e80d33b4-612a-48c3-ab46-4975dc069e10</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheUNLRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOSmall"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginNCSA">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSA"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginNCSARouter"/>
    <topology:hasGUID>fdf338d2-14c1-4113-902d-0b46bb12d155</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginNCSARouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNLRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d081ee9c-ecb7-4c8c-bb7e-e14198ffc393</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheUC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheUC"/>
    <topology:hasGUID>ec849adf-daf8-45fa-9e7b-58a3cab685e5</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheStarLightRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOSmall"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-ESNET-ip-10-100-7-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.7.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNL"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNLRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>96028be4-951d-462a-8bec-c7abb0750858</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNL">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNL-ip-192-168-16-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCENICRouter">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CacheCENICRouter"/>
    <topology:hasGUID>1c2295a6-6013-487f-b0d3-590697acb8b2</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheCENICRouter"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCENICRouter"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-CacheCENICRouter"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-CENIC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-StarLight"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>da3c4fda-307f-4f56-bc56-a3c27d8b506c</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CENIC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CENIC-ip-10-100-12-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNY"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNYRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c6aa9d08-f183-4831-bc32-510e470aa9c7</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCal">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCal-ip-192-168-19-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUNL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNL"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginUNLRouter"/>
    <topology:hasGUID>9ae9e32e-45b5-4d45-bbed-8319028fb63a</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginUNLRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNL-ip-192-168-20-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.20.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-CENIC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>7e633108-9a86-407b-867b-51d7a6335350</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-CacheNYRouter-ip-172-16-27-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.27.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-CacheCENICRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-CacheCENICRouter-ip-172-16-4-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheSDSC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheSDSC"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCENICRouter"/>
    <topology:hasGUID>086eab16-57d8-431d-a874-de91d2b91898</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheCENICRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOSmall"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-OriginCalRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-OriginCalRouter-ip-172-16-22-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#I2">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link3-I2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-I2"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp


</request-schema:postBootScript>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-I2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-I2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-I2"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-I2"/>
    <topology:hasGUID>db50f928-5e59-4bb0-bf70-a82f85c4a4c6</topology:hasGUID>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-I2"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-OriginUNLRouter-ip-172-16-14-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.14.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheFNAL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheFNAL"/>
    <topology:hasGUID>8f562208-6182-4ba7-a610-1e7cb49be647</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheStarLightRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOSmall"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheUC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>a3e89017-7398-4e18-98ae-7c3848797817</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-I2-ip-10-100-2-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-OriginNCSARouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>e1fecf7f-f612-4e32-96d8-33936aa4b385</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginSDSC">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSC"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginSDSCRouter"/>
    <topology:hasGUID>f4f228a0-a9b8-44e7-9890-2b8b50da65f9</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginSDSCRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOMedium"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#StarLight">
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-StarLight"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-StarLight"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-StarLight"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-StarLight"/>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-StarLight"/>
    <topology:hasGUID>4cf9a77e-76eb-4e04-84ba-878acaabb046</topology:hasGUID>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginStarLightRouter-ip-192-168-21-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.21.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-CENIC-ip-10-100-1-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.1.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-StarLight">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-StarLight-ip-10-100-6-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-OriginSDSCRouter-ip-172-16-5-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.5.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CENIC-ip-10-100-12-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.12.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-CacheStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-CacheStarLightRouter-ip-172-16-24-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNLRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNLRouter-ip-192-168-20-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2">
    <topology:hasName rdf:datatype="http://www.w3.org/2001/XMLSchema#string">Ubuntu 18.04 QCOW2 v1.0.2</topology:hasName>
    <topology:hasURL>http://geni-images.renci.org/images/standard/ubuntu-comet/ubuntu-18.04/ubuntu-18.04.xml</topology:hasURL>
    <topology:hasGUID>fe66b08bffa14c385ad64edd124350a2da826af9</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#DiskImage"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheFNAL-ip-192-168-26-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.26.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-I2-ip-10-100-2-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.2.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-ESNET">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-ESNET-ip-172-16-4-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-ESNET">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-ESNET-ip-10-100-7-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-I2-ip-10-100-0-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.0.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-ESNET">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-ESNET-ip-172-16-22-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-ESNET">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-ESNET-ip-10-100-2-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-OriginSDSCRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-OriginSDSCRouter-ip-172-16-5-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-OriginCalRouter-ip-172-16-22-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.22.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-CENIC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-CENIC-ip-10-100-1-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-CENIC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-CENIC-ip-172-16-5-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-CENIC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-CENIC-ip-10-100-0-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheCENICRouter-ip-192-168-18-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.18.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-OriginUNLRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-I2"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>98acaf82-8b45-48ab-909d-6162766ed25a</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-CENIC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-CENIC-ip-10-100-9-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSC-ip-192-168-17-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.17.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-StarLight">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-StarLight-ip-172-16-10-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link4-ESNET-ip-172-16-4-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.4.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheStarLightRouter-ip-192-168-25-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheFNAL"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>c4591e03-a952-4d1b-a2f5-f39198744dff</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-ESNET">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link1-ESNET-ip-10-100-1-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-OriginStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-OriginStarLightRouter-ip-172-16-10-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginCalRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCalRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link22-OriginCalRouter"/>
    <topology:hasGUID>91f8b495-4dc9-4fae-93c6-8fa50abbbcda</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp


</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginStarLightRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-OriginStarLightRouter"/>
    <topology:hasGUID>d903497f-e9d6-40d7-8106-80780993cdf5</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheStarLightRouter-ip-192-168-25-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.25.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCalRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCalRouter-ip-192-168-23-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheSDSC-ip-192-168-18-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.18.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link0-I2-ip-10-100-0-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheCENICRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link18-CacheCENICRouter-ip-192-168-18-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-ESNET"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-StarLight"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>370fd319-bc91-405e-8ff0-a01bc965e055</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link10-OriginStarLightRouter-ip-172-16-10-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.10.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheStarLightRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheStarLightRouter-ip-192-168-26-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Term">
    <time:hasDurationDescription rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#TermDuration"/>
    <rdf:type rdf:resource="http://www.w3.org/2006/time#Interval"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNY-ip-192-168-28-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.28.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheStarLightRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link26-CacheStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheStarLightRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-CacheStarLightRouter"/>
    <topology:hasGUID>948c8a82-78e6-4108-986c-79a141f0def1</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSARouter-ip-192-168-15-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.15.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginStarLightRouter-ip-192-168-11-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.11.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-OriginNCSARouter-ip-172-16-13-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.13.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginFNAL-ip-192-168-21-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.21.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-StarLight-ip-172-16-24-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.24.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNLRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link16-OriginUNLRouter-ip-192-168-16-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCalRouter-ip-192-168-23-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.23.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-I2">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link13-I2-ip-172-16-13-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheNYRouter">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNYRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-CacheNYRouter"/>
    <topology:hasGUID>a65a4433-9d65-4147-8cfc-8cd7ce416a01</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash

echo ! &gt; /root/tmp
#wait for Internet
while ! ping -c1 127.0.0.53 &amp;&gt;/dev/null
        do echo "Ping Fail" &gt;&gt; /root/tmp
        sleep 2
done
echo "Internet is ready" &gt;&gt; /root/tmp

#Install Quagaa
until apt-get update -y
do
        echo "updating Ubunut...." &gt;&gt; /root/tmp
        sleep 2
done
until apt-get install -y quagga
do
        echo "installing quagga...." &gt;&gt; /root/tmp
        sleep 2
done

echo 'VTYSH_PAGER=more' &gt;&gt;/etc/environment 
echo 'export VTYSH_PAGER=more' &gt;&gt;/etc/bash.bashrc

#cp /usr/share/doc/quagga/examples/zebra.conf.sample /etc/quagga/zebra.conf
#cp /usr/share/doc/quagga/examples/ospfd.conf.sample /etc/quagga/ospfd.conf

#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )

echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#wait for interfaces
echo $numIntf &gt;&gt; /root/tmp
size=0
while [ $size -lt $numIntf ]
do
filelist=( $(ls /etc/udev/rules.d) )
size="${#filelist[@]}"
done
echo $size $numIntf &gt;&gt; /root/tmp

#ospfd.conf
echo ! &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $ospfLink in $linkset )
#set ( $mac = $self.MAC( $ospfLink ) )
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
ospfIntf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $ospfIntf &gt;&gt; /root/tmp
echo interface $ospfIntf &gt;&gt; /etc/quagga/ospfd.conf
fi
done
#end

echo router ospf &gt;&gt; /etc/quagga/ospfd.conf
#foreach ( $link in $linkset )
  #set ( $IP=$self.IP($link) ) 
  #set ( $MASK=$self.Netmask($link) )
  IFS=. read -r i1 i2 i3 i4 &lt;&lt;&lt; $IP
  #if ( $MASK == "/24" )
    SUBNET="$i1.$i2.$i3.0"
  #end
  #if ( $MASK == "/16" )
    SUBNET="$i1.$i2.0.0"
  #end
  echo  network $SUBNET$MASK area 0 &gt;&gt; /etc/quagga/ospfd.conf
#end
echo line vty &gt;&gt; /etc/quagga/ospfd.conf

#zebra.conf

echo ! &gt; /etc/quagga/zebra.conf

#foreach ( $zebralink in $linkset )
#set ( $IP=$self.IP( $zebralink ) )
#set ( $MASK=$self.Netmask( $zebralink ) )
#set ( $mac = $self.MAC( $zebralink ) )
echo $IP$MASK $mac  &gt;&gt; /root/tmp
for file in /etc/udev/rules.d/*
do
if grep -q $mac $file
then
echo $file &gt;&gt; /root/tmp
intf=$(cat $file | sed -n -e 's/^\(.*\)\(ens[0-9]*\)\(.*\)/\2/p' )
echo $intf &gt;&gt; /root/tmp
echo interface $intf &gt;&gt; /etc/quagga/zebra.conf
fi
done
echo ip address $IP$MASK &gt;&gt; /etc/quagga/zebra.conf
#end
echo ip forwarding &gt;&gt; /etc/quagga/zebra.conf

#start zebra and ospfd

systemctl enable zebra
systemctl start zebra
systemctl enable ospfd
systemctl start ospfd

#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp


</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-CacheNYRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link27-CacheNYRouter-ip-172-16-27-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCal"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCalRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>3a588cf0-65d6-44e2-a9b1-1f6f15bb79ac</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheNY">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNY"/>
    <topology:hasGUID>8a96874d-21ec-4f2c-b375-9e3f4ca72977</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheNYRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOSmall"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginUC"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginStarLightRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>ff2e1d07-96e1-43a7-8363-3029a0ad7fc9</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-I2"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-StarLight"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>d6c3f259-fdf4-4901-8500-08bb255a8c25</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link14-I2-ip-172-16-14-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.14.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCal"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCENICRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>8975a27a-f6f8-44f4-831b-1c984d1a470d</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link28-CacheNYRouter-ip-192-168-28-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.28.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link20-CacheUNLRouter-ip-192-168-20-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.20.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link2-ESNET-ip-10-100-2-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.2.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-StarLight">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link7-StarLight-ip-10-100-7-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#TermDuration">
    <time:days rdf:datatype="http://www.w3.org/2001/XMLSchema#decimal">1</time:days>
    <rdf:type rdf:resource="http://www.w3.org/2006/time#DurationDescription"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginUC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link11-OriginUC-ip-192-168-11-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSA-ip-192-168-15-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.15.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link25-CacheUC-ip-192-168-25-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.25.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-StarLight"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-CacheStarLightRouter"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>1beae374-452b-4222-91c2-565cb24b7d25</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-CENIC-ip-172-16-5-2">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>172.16.5.2</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CacheCENICRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link12-CENIC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>9eb13431-d4cf-46a3-8790-704b37c241ae</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-StarLight">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link24-StarLight-ip-172-16-24-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-OriginSDSCRouter"/>
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link5-CENIC"/>
    <layer:atLayer rdf:resource="http://geni-orca.renci.org/owl/ethernet.owl#EthernetNetworkElement"/>
    <layer:bandwidth rdf:datatype="http://www.w3.org/2001/XMLSchema#integer">10000000</layer:bandwidth>
    <topology:hasGUID>252484e8-a930-4f4d-ad6b-89b0258f1b27</topology:hasGUID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#NetworkConnection"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-StarLight-ip-10-100-9-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.9.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSARouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link15-OriginNCSARouter-ip-192-168-15-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSC">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSC-ip-192-168-17-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCal">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link19-CacheCal"/>
    <request-schema:dependOn rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#CacheCENICRouter"/>
    <topology:hasGUID>7dcd580d-3400-4b95-befc-d8c7b3bf928c</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $CacheCENICRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link6-StarLight-ip-10-100-6-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>10.100.6.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link23-OriginCal-ip-192-168-23-3">
    <ip4:netmask>255.255.255.0</ip4:netmask>
    <layer:label_ID>192.168.23.3</layer:label_ID>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/ip4.owl#IPAddress"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-StarLight">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link9-StarLight-ip-10-100-9-3"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSCRouter">
    <ip4:localIPAddress rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link17-OriginSDSCRouter-ip-192-168-17-2"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/topology.owl#Interface"/>
  </rdf:Description>
  <rdf:Description rdf:about="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#OriginFNAL">
    <topology:hasInterface rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Link21-OriginFNAL"/>
    <topology:hasGUID>7efa4cb3-f641-44d0-82c3-7b4681446b27</topology:hasGUID>
    <request-schema:postBootScript rdf:datatype="http://www.w3.org/2001/XMLSchema#string">#!/bin/bash
  
#set ( $linkset = $self.Links()  )
#set ( $linksetstr = $self.AllLinks()  )
#set ( $num = $linkset.size() )
#set ( $numIntf = $num + 2 )
echo $linkset &gt;&gt; /root/tmp
echo $linksetstr &gt;&gt; /root/tmp

#set ( $link = $linkset[0] )
echo $link &gt; /root/tmp
#set ( $gw = $OriginStarLightRouter.IP($link) )
echo $gw &gt; /root/tmp

while ! ping -c 1 -n -w 1 $gw &amp;&gt; /dev/null
do
    echo "ping gw...." &gt;&gt; /root/tmp
    sleep 2
done
echo "\n%s\n"  "Server is back online" &gt;&gt; /root/tmp

ip route add 10.100.0.0/16 via $gw dev ens6
ip route add 172.16.0.0/16 via $gw dev ens6
ip route add 192.168.0.0/16 via $gw dev ens6

#set ( $hostname = $self.Name() )
echo $hostname:$gw &gt; /root/tmp_gw
#foreach ( $link2 in $linkset )
  #set ( $IP=$self.IP($link2) )
  echo export $self.Name()_$link2="$IP" &gt;&gt; /root/tmp_links.sh
#end

echo "Installing CJ and apache2" &gt;&gt; /root/tmp
cd /root
git clone --branch storage https://github.com/RENCI-NRIG/chaos-jungle.git
date &gt;&gt; /root/tmp
until apt-get -y install apache2
do
        echo "installing apache2" &gt;&gt; /root/tmp
        sleep 2
done
date &gt;&gt; /root/tmp
mkdir -p /root/iris
cp -r /root/chaos-jungle/experiment/testdata /root/iris
cp chaos-jungle/experiment/v1/000-default.conf /etc/apache2/sites-available
mkdir -p /var/www/iris
service apache2 reload
apt-key adv --keyserver keyserver.ubuntu.com --recv-keys 4052245BD4284CDD
echo "deb https://repo.iovisor.org/apt/$(lsb_release -cs) $(lsb_release -cs) main" | sudo tee /etc/apt/sources.list.d/iovisor.list
apt-get -y update
apt-get -y install bcc-tools libbcc-examples linux-headers-$(uname -r)
apt-get -y install python3-bcc
apt-get -y install python3-pyroute2 python-pyroute2 iperf3
apt install -y python3-pip python3-setuptools
pip3 install python-crontab  
date &gt;&gt; /root/tmp
python3 /root/chaos-jungle/storage/cj_storage.py --revert &gt;&gt; /root/tmp
echo "done" &gt;&gt; /root/tmp

</request-schema:postBootScript>
    <compute:diskImage rdf:resource="http://geni-orca.renci.org/owl/26067db0-2e26-4361-825d-904fe0968bbd#Ubuntu+18.04+QCOW2+v1.0.2"/>
    <compute:specificCE rdf:resource="http://geni-orca.renci.org/owl/exogeni.owl#XOLarge"/>
    <domain:hasResourceType rdf:resource="http://geni-orca.renci.org/owl/compute.owl#VM"/>
    <rdf:type rdf:resource="http://geni-orca.renci.org/owl/compute.owl#ComputeElement"/>
  </rdf:Description>
</rdf:RDF>
